{% extends "layout.html" %}

{% block content %}
<div class="main-visualization">
    <h1 class="vis-title">Data Visualization</h1>
    <div class="main">
        <!-- Chart Display Section -->
        <div class="main-canvas">
            <!-- Tab Navigation -->
            <div class="tabs-vis">
                <button class="tab-vis active-tab" id="bar-chart-tab">Bar Chart</button>
                <button class="tab-vis" id="bubble-chart-tab">Bubble Chart</button>
                <button class="tab-vis" id="histogram-tab">Histogram</button>
                <button class="tab-vis" id="pie-chart-tab">Pie Chart</button>
                <button class="tab-vis" id="radar-chart-tab">Radar Chart</button>
            </div>
            <!-- Canvas for Charts -->
            <div class="canvas">
                <canvas id="bar-chart" class="chart"></canvas>
                <canvas id="bubble-chart" class="chart hidden"></canvas>
                <canvas id="histogram" class="chart hidden"></canvas>
                <canvas id="pie-chart" class="chart hidden"></canvas>
                <canvas id="radar-chart" class="chart hidden"></canvas>
            </div>
        </div>

        <!-- Customization Panel -->
        <div class="tabs-cust">
            <div class="customization">
                <h2 class="cust-title">Customize Charts</h2>

                <!-- Common Customization -->
                <label for="x-axis">X-Axis:</label>
                <select id="x-axis"></select>

                <label for="y-axis">Y-Axis:</label>
                <select id="y-axis"></select>

                <!-- Bar Chart -->
                <div id="bar-chart-options" class="chart-options">
                    <label for="bar-color">Bar Color:</label>
                    <input type="color" id="bar-color" value="#007bff">
                </div>

                <button class="apply-btn" id="apply-customization">Apply</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    let barChart, activeChart;

    // Simulated chart data
    const chartData = {
        columns: ['Category', 'Value'],
        data: {
            'Category': ['A', 'B', 'C', 'D', 'E'],
            'Value': [10, 20, 15, 30, 25]
        }
    };

    const xAxisDropdown = document.getElementById('x-axis');
    const yAxisDropdown = document.getElementById('y-axis');

    function populateDropdowns() {
        chartData.columns.forEach(column => {
            const xOption = document.createElement('option');
            xOption.value = column;
            xOption.textContent = column;
            xAxisDropdown.appendChild(xOption);

            const yOption = document.createElement('option');
            yOption.value = column;
            yOption.textContent = column;
            yAxisDropdown.appendChild(yOption);
        });

        // Set default selections
        if (chartData.columns.length > 0) {
            xAxisDropdown.value = chartData.columns[0];
            yAxisDropdown.value = chartData.columns[1] || chartData.columns[0];
        }
    }

    function renderChart(type, ctx, config) {
        if (activeChart) activeChart.destroy();
        activeChart = new Chart(ctx, config);
    }

    function renderBarChart() {
        const ctx = document.getElementById('bar-chart').getContext('2d');
        renderChart('bar', ctx, {
            type: 'bar',
            data: {
                labels: chartData.data[xAxisDropdown.value],
                datasets: [{
                    label: `${xAxisDropdown.value} vs ${yAxisDropdown.value}`,
                    data: chartData.data[yAxisDropdown.value],
                    backgroundColor: document.getElementById('bar-color').value
                }]
            },
            options: { responsive: true }
        });
    }

    document.getElementById('apply-customization').addEventListener('click', function () {
        renderBarChart();
    });

    // Initialize dropdowns and render default chart
    document.addEventListener('DOMContentLoaded', () => {
        populateDropdowns();
        renderBarChart();
    });
</script>
{% endblock %}
